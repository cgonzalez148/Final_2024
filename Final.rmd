---
title: "Covid91 vaccine study Final2024"
author: "Citlali Gonzalez"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

### Males

$H_0$: The covid vaccine does not have an impact on males     
$H_A$: The covid vaccine does have an impact on males 

## Methods

Infected is a categorical variable     
Treatment is categorical variable     
The helper file I used is Cat~Cat 

## Descriptive Results

### Graphical Descriptive Results

```{r}
males=filter(FinalData,FinalData$sex=="M")
barchartGC(~treatment + infected, data=males)
barchartGC(~infected +treatment, data=males,type="percent")

```
     
This graph indicates that males who received the vaccine are less likely to get covid-19 compared to those who got a placebo.

### Numerical Descriptive Results

```{r}
table1 <- xtabs(~treatment +infected, data=males)
rowPerc(table1)
colPerc(table1)
```
     
This numerical summary shows that 74% of males who received the placebo got covid-19, whereas only 26% of those who received the vaccine did.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The odds ratio of 2.81:1 which means that the individuals who took the placebo are 2.81 times more likely to contract covid-19 compared to those who got the vaccine.          

The p-value for the chi-square test is 0.0000000000000002, the fishers exact test yields a p-value of 0.000000000000002. Therefore, we reject the null hypothesis. 

### Conclusion

The graph shows that the men who were vaccinated had a significantly lower risk of getting covid19 compared to those that received a placebo. The data shows that 74% of males who received the placebo contracted covid19, while only 26% of those who were vaccinated did. The odds ratio of 2.81:1 indicates that those who received the placebo are 2.81 times more likely to contract COVID-19 than those who were vaccinated. The chi-square test yielded a p-value of 0.00000000000000002, and Fisher's exact test produced a p-value of 0.00000000000000002, both of which are well below 0.05, showing significant results.       

### Females

$H_0$: The covid vaccine does not have an impact on females      
$H_A$: The covid vaccine does have an impact on females

## Methods

Sex (Female) is a categorical variable     
Treatment is categorical variable     
The helper file I used is Cat~Cat 

## Descriptive Results

### Graphical Descriptive Results

```{r}
femaleData = filter (FinalData,sex == "F")
```

```{r}
females=filter(FinalData,FinalData$sex=="M")
barchartGC(~treatment + infected, data=females)
barchartGC(~infected +treatment, data=females,type="percent")

```

This graph indicates that females who received the vaccine are less likely to contract covid19 compared to females who received the placebo.

### Numerical Descriptive Results

```{r}
table2 <- xtabs(~infected + treatment, data=femaleData)
rowPerc(table2)
colPerc(table2)
```

This numerical summary shows that 65% of females who received the placebo were infected with covid-19, whereas 35% of females who received the vaccine got the virus.

### Inferential Results

```{r}
chisq.test(table2)
chisqtestGC(table2)
fisher.test(table2)
```

This numerical summary shows that the odds ratio is 1.85:1, indicating that females who got the placebo are 1.85 times more likely to contract covid-19 compared to females who were vaccinated. 

The chi-square test yields a p-value of 0.00000002, indicating a significant difference which results in rejecting the null hypothesis.       
The fisher's exact test has a p-value of 0.00000001, which is lower than 0.05 resulting in us rejecting the null hypothesis.  

### Conclusion

The results indicate that females who received the vaccine have a lower risk of contracting covid-19 compared to those who received the placebo. The data shows that 65% of females that took a placebo were infected with covid-19, while only 35% of those who received the vaccine were infected. The odds ratio of 1.85:1 suggests that females in the placebo group were 1.85 times more likely to get covid-19 compared to those who were vaccinated. The chi-square test returned a p-value of 0.00000002 which is below 0.05 which results in rejecting the null hypothesis. The fisher's exact test yielded a p-value of 0.00000001 which is also below 0.05 meaning we reject the null hypothesis. 

## LGBTQ

$H_0$ The covid vaccine does not have an impact on the LGBTQ community     
$H_A$ The covid vaccine does have an impact on the LGBTQ community

## Methods

Sex (LGBTQ) is a categorical variable     
Treatment is categorical variable     
The helper file I used is Cat~Cat

## Descriptive Results

### Graphical Descriptive Results

```{r}
LGBTQData = filter (FinalData,LGBTQ == "gay")
```

```{r}
barchartGC(~infected+treatment,data=LGBTQData)
barchartGC(~infected+treatment,data=LGBTQData, type="percent")
```

This graph shows that in the LGBTQ group, those who were vaccinated have a lower risk of getting covid-19 compared to those who received the placebo. 

### Numerical Descriptive Results 

```{r}
table3 <- xtabs(~ treatment + infected, data=LGBTQData)
rowPerc(table3)
colPerc(table3)
```

This numerical summary indicates that in the LGBTQ placebo group, 80% experienced symptoms, whereas omly 20% of those in the vaccinated group did. 

### Inferential Results

```{r}
chisq.test(table3)
chisqtestGC(table3)
fisher.test(table3)
```

This numerical summary shows that the odds ratio is 4.27:1, indicating that LGBTQ group who got the placebo are 4.27 times more likely to contract covid-19 compared to the LGBTQ group who was vaccinated. 

The chi-square test reveals a p-value of 0.000002, which is below 0.05 resulting in rejecting the null hypothesis.     
The fisher's exact test provides a p-value of 0.00000007, which is also below 0.05 resulting in rejecting the null hypothesis.

### Conclusion 

The graph demonstrates that the LGBTQ group that was vaccinated have a significantly lower risk of getting covid-19 compared to those who got a placebo. The numerical summary shows that 80% of the LGBTQ placebo group had symptoms, while only 20% of the vaccinated group did. The odds ratio was 4.27:1 which meant that the group who got the placebo was 4.27 times more likely to get covid-19 compared to the vaccinated group. The chi-square test produced a p-value of 0.000002, which is below 0.05 resulting in rejecting the null hypothesis. The fishers exact test resulted in a p-value of 0.00000007, which is also below 0.05, tjis indicates a significant difference between the two groups which further supports rejecting the null hypothesis within this subgroup.  

# Druggies

$H_0$ The COVID vaccine has no impact on the Drug User
$H_A$ The COVID vaccine has an impact on the Drug User

## Methods 

Drug User is a categorical variable    
Treatment is categorical variable     
The helper file I used is Cat~Cat

## Descriptive Results 

### Graphical Descriptive Results

```{r}
DruggiesData = filter(FinalData, DrugUser == "yes")
```

```{r}
barchartGC(~infected+treatment,data=DruggiesData)
barchartGC(~infected+treatment,data=DruggiesData, type="percent")
```

This graph indicates that drug users who received the placebo were less likely to get covid-19 compared to those who received the vaccine.

### Numerical Descriptive Results

```{r}
table4 <- xtabs(~ treatment + infected, data=DruggiesData)
rowPerc(table4)
colPerc(table4)
```

This numerical summary shows that the drug users who took a placebo experience 8.33% of the symptoms, whereas the vaccinated group 91.67% of the symptoms. 

### Inferential Results

```{r}
chisq.test(table4)
chisqtestGC(table4)
fisher.test(table4)
```

This numerical summary shows that the odds ratio is 0.087:1, indicating that DrugUser group who got the placebo are 0.087 times less likely compared to the DrugUser group who was vaccinated. 

The chi-square test yields a p-value of 0.0000000001, which is belo 0.05 resulting in rejecting the null hypothesis.     
The fisher's exact test provides a p-value of 0.000000000003 which is also lower than 0.05 which shows a significant difference between the two groups and it supports the rejection of the null hypothesis. 

### Conclusion

The graph shows that the DrugUsers who received the placebo were more likely to contract covid-19 compared to those who received the vaccine. According to the table, 8.33% of drug users in the placebo group experienced symptoms, whereas 91.67% of those in the vaccinated group did. The odds ratio of 0.087:1 indicates that drug users who received the placebo were 0.087 times less likely to contract COVID-19 compared to the DrugUsers who received the vaccine. The chi-square test produced a p-value of 0.0000000001 which is below 0.05, resulting in the rejection of the null hypothesis. The fisher's exact test resulted in a p-value of 0.000000000003 which is also less than 0.05, supporting the rejection of the null hypothesis and showing a significant difference between the two groups.

# Overall Results and Conclusions